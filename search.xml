<context>
 <input pattern="* (привет*|здравствуй*) *">
        <output if="full($UserName)">
            <item value="Привет, $UserName! Рада снова видеть тебя!"/>
            <item value="Здравствуй, $UserName! Я уже успела соскучиться...Что для Вас найти?"/>
        </output>

        <context if="empty($UserName)" id="name">
            <output value="Привет! Меня зовут Алиса, я помощник по поиску деталей для автомобилей! Как Вас зовут?"/>

            <input pattern="$Text">
                <var name="UserName" value="cap($Text)" scope="user"/>
                <output value="Приятно познакомиться, $UserName! Какой номер детали Вам найти?"/>
                <context/>
            </input>
        </context>
    </input>

    <input pattern="* пока *">
        <var name="end_session" value="javascript: true"/>
        <output value="Ну пока, незнакомец!" if="empty($UserName)"/>
        <output value="Пока-пока, $UserName!"/>
    </input>

    <input pattern="[* (кто|что) так*] $Text">
        <context id="name" if="empty($UserName)"/>
         <sample>
        <item value="Перейти на сайт f-detali.com"/>
        </sample>
        
  
    <output channel="facebook">
  <![CDATA[
    "attachment":{
      "type":"template",
      "payload":{
        "template_type":"generic",
        "elements":[
          {
            "title":"Welcome $UserName",
            "image_url":"https://img1.goodfon.ru/wallpaper/big/1/ca/foto-makro-kartinka-zelenye.jpg",
            "subtitle":"Nice yo see you again!",
            "buttons":[
              {
                "type":"web_url",
                "url":"https://petersapparel.parseapp.com/view_item?item_id=100",
                "title":"View Website"
              },
              {
                "type":"postback",
                "title":"Start Chatting",
                "payload":"USER_DEFINED_PAYLOAD"
              }
            ]
          }
        ]
      }
    }
  ]]>
</output>
     
    </input>
</context>
